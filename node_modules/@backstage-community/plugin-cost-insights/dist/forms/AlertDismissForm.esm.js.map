{"version":3,"file":"AlertDismissForm.esm.js","sources":["../../src/forms/AlertDismissForm.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  ChangeEvent,\n  useEffect,\n  useState,\n  forwardRef,\n  FormEventHandler,\n} from 'react';\nimport Box from '@material-ui/core/Box';\nimport Collapse from '@material-ui/core/Collapse';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport Radio from '@material-ui/core/Radio';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport {\n  Alert,\n  AlertFormProps,\n  AlertDismissReason,\n  AlertDismissOptions,\n  AlertDismissFormData,\n} from '../types';\nimport { Maybe } from '@backstage-community/plugin-cost-insights-common';\nimport { useAlertDialogStyles as useStyles } from '../utils/styles';\n\nexport type AlertDismissFormProps = AlertFormProps<Alert, AlertDismissFormData>;\n\nexport const AlertDismissForm = forwardRef<\n  HTMLFormElement,\n  AlertDismissFormProps\n>(({ onSubmit, disableSubmit }, ref) => {\n  const classes = useStyles();\n  const [other, setOther] = useState<Maybe<string>>(null);\n  const [feedback, setFeedback] = useState<Maybe<string>>(null);\n  const [reason, setReason] = useState<AlertDismissReason>(\n    AlertDismissReason.Resolved,\n  );\n\n  const onFormSubmit: FormEventHandler = e => {\n    e.preventDefault();\n    if (reason) {\n      onSubmit({\n        other: other,\n        reason: reason,\n        feedback: feedback,\n      });\n    }\n  };\n\n  const onReasonChange = (_: ChangeEvent<HTMLInputElement>, value: string) => {\n    if (other) {\n      setOther(null);\n    }\n    setReason(value as AlertDismissReason);\n  };\n\n  const onOtherChange = (e: ChangeEvent<HTMLInputElement>) => {\n    return e.target.value\n      ? setOther(e.target.value as AlertDismissReason)\n      : setOther(null);\n  };\n\n  const onFeedbackChange = (e: ChangeEvent<HTMLInputElement>) => {\n    return e.target.value\n      ? setFeedback(e.target.value as AlertDismissReason)\n      : setFeedback(null);\n  };\n\n  useEffect(() => {\n    function validateDismissForm() {\n      if (reason === AlertDismissReason.Other) {\n        if (other) {\n          disableSubmit(false);\n        } else {\n          disableSubmit(true);\n        }\n      } else if (reason) {\n        disableSubmit(false);\n      } else {\n        disableSubmit(true);\n      }\n    }\n\n    validateDismissForm();\n  }, [reason, other, disableSubmit]);\n\n  return (\n    <form ref={ref} onSubmit={onFormSubmit}>\n      <FormControl component=\"fieldset\" fullWidth>\n        <Typography color=\"textPrimary\">\n          <b>Reason for dismissing?</b>\n        </Typography>\n        <Box mb={1}>\n          <RadioGroup\n            name=\"dismiss-alert-reasons\"\n            value={reason}\n            onChange={onReasonChange}\n          >\n            {AlertDismissOptions.map(option => (\n              <FormControlLabel\n                key={`dismiss-alert-option-${option.reason}`}\n                label={option.label}\n                value={option.reason}\n                control={<Radio className={classes.radio} />}\n              />\n            ))}\n          </RadioGroup>\n          <Collapse in={reason === AlertDismissReason.Other}>\n            <Box ml={4}>\n              <TextField\n                id=\"dismiss-alert-option-other\"\n                variant=\"outlined\"\n                multiline\n                fullWidth\n                rows={4}\n                value={other ?? ''}\n                onChange={onOtherChange}\n              />\n            </Box>\n          </Collapse>\n        </Box>\n        <Typography gutterBottom>\n          <b>Any other feedback you can provide?</b>\n        </Typography>\n        <TextField\n          id=\"dismiss-alert-feedback\"\n          variant=\"outlined\"\n          multiline\n          rows={4}\n          fullWidth\n          value={feedback ?? ''}\n          onChange={onFeedbackChange}\n        />\n      </FormControl>\n    </form>\n  );\n});\n"],"names":["useStyles"],"mappings":"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"}