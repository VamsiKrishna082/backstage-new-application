{"version":3,"file":"alerts.esm.js","sources":["../../src/utils/alerts.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Alert, AlertForm, AlertStatus } from '../types';\nimport { Maybe } from '@backstage-community/plugin-cost-insights-common';\nimport { AlertAcceptForm, AlertDismissForm, AlertSnoozeForm } from '../forms';\n\nconst createAlertHandler = (status?: AlertStatus) => (alert: Alert) =>\n  alert.status === status;\nexport const isAlertActive = (alert: Alert) => !hasProperty(alert, 'status');\nexport const isAlertSnoozed = createAlertHandler(AlertStatus.Snoozed);\nexport const isAlertAccepted = createAlertHandler(AlertStatus.Accepted);\nexport const isAlertDismissed = createAlertHandler(AlertStatus.Dismissed);\n\nconst createStatusHandler = (status: AlertStatus) => (s: Maybe<AlertStatus>) =>\n  s === status;\nexport const isStatusSnoozed = createStatusHandler(AlertStatus.Snoozed);\nexport const isStatusAccepted = createStatusHandler(AlertStatus.Accepted);\nexport const isStatusDismissed = createStatusHandler(AlertStatus.Dismissed);\n\nconst createAlertEventHandler =\n  (onEvent: 'onSnoozed' | 'onAccepted' | 'onDismissed') =>\n  (alert: Maybe<Alert>): boolean =>\n    hasProperty(alert, onEvent);\nexport const isSnoozeEnabled = createAlertEventHandler('onSnoozed');\nexport const isAcceptEnabled = createAlertEventHandler('onAccepted');\nexport const isDismissEnabled = createAlertEventHandler('onDismissed');\n\nconst createFormEnabledHandler =\n  (Form: 'SnoozeForm' | 'AcceptForm' | 'DismissForm') =>\n  (alert: Maybe<Alert>): boolean => {\n    if (!alert) return false;\n    if (alert[Form] === null) return false;\n    switch (Form) {\n      case 'SnoozeForm':\n        return isSnoozeEnabled(alert);\n      case 'AcceptForm':\n        return isAcceptEnabled(alert);\n      case 'DismissForm':\n        return isDismissEnabled(alert);\n      default:\n        return false;\n    }\n  };\nexport const isSnoozeFormEnabled = createFormEnabledHandler('SnoozeForm');\nexport const isAcceptFormEnabled = createFormEnabledHandler('AcceptForm');\nexport const isDismissFormEnabled = createFormEnabledHandler('DismissForm');\n\n/**\n * Utility for determining if a form is disabled.\n * When a form is disabled, the dialog button's type should convert from submit to button.\n * @param alert\n * @param status\n */\nexport const isFormDisabled = (\n  alert: Maybe<Alert>,\n  status: Maybe<AlertStatus>,\n): boolean => {\n  switch (status) {\n    case AlertStatus.Snoozed:\n      return alert?.SnoozeForm === null;\n    case AlertStatus.Accepted:\n      return alert?.AcceptForm === null;\n    case AlertStatus.Dismissed:\n      return alert?.DismissForm === null;\n    default:\n      return false;\n  }\n};\n\nexport function formOf(\n  alert: Maybe<Alert>,\n  status: Maybe<AlertStatus>,\n): Maybe<AlertForm> {\n  switch (status) {\n    case AlertStatus.Snoozed: {\n      const SnoozeForm = alert?.SnoozeForm ?? AlertSnoozeForm;\n      return isSnoozeFormEnabled(alert) ? SnoozeForm : null;\n    }\n    case AlertStatus.Accepted: {\n      const AcceptForm = alert?.AcceptForm ?? AlertAcceptForm;\n      return isAcceptFormEnabled(alert) ? AcceptForm : null;\n    }\n    case AlertStatus.Dismissed: {\n      const DismissForm = alert?.DismissForm ?? AlertDismissForm;\n      return isDismissFormEnabled(alert) ? DismissForm : null;\n    }\n    default:\n      return null;\n  }\n}\n\n/**\n * Utility for choosing from a fixed set of values for a given alert status.\n * @param status\n * @param values\n */\nexport function choose<T>(\n  status: Maybe<AlertStatus>,\n  values: [T, T, T],\n  none: T,\n): T {\n  switch (status) {\n    case AlertStatus.Snoozed:\n      return values[0];\n    case AlertStatus.Accepted:\n      return values[1];\n    case AlertStatus.Dismissed:\n      return values[2];\n    default:\n      return none;\n  }\n}\n\nexport function hasProperty(alert: Maybe<Alert>, prop: keyof Alert): boolean {\n  return prop in (alert ?? {});\n}\n\nexport const sumOfAllAlerts = (sum: number, alerts: Alert[]) =>\n  sum + alerts.length;\n"],"names":[],"mappings":"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"}