{"version":3,"file":"history.esm.js","sources":["../../src/utils/history.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport qs from 'qs';\nimport * as yup from 'yup';\nimport { Duration, PageFilters } from '../types';\nimport { Group } from '@backstage-community/plugin-cost-insights-common';\nimport { getDefaultPageFilters } from '../utils/filters';\nimport { ConfigContextProps } from '../hooks/useConfig';\n\nconst schema = yup\n  .object()\n  .shape({\n    group: yup.string().nullable(),\n    project: yup.string().nullable(),\n  })\n  .required();\n\nexport const stringify = (queryParams: Partial<PageFilters>) =>\n  qs.stringify(queryParams, { strictNullHandling: true });\n\nexport const parse = (queryString: string): Partial<PageFilters> =>\n  qs.parse(queryString, { ignoreQueryPrefix: true, strictNullHandling: true });\n\nexport const validate = (queryString: string): Promise<PageFilters> => {\n  return schema.validate(parse(queryString), {\n    stripUnknown: true,\n    strict: true,\n  }) as Promise<PageFilters>;\n};\n\nexport const getInitialPageState = (\n  groups: Group[],\n  queryParams: Partial<PageFilters> = {},\n) => {\n  return {\n    ...getDefaultPageFilters(groups),\n    ...(queryParams.project ? { project: queryParams.project } : {}),\n    ...(queryParams.group ? { group: queryParams.group } : {}),\n  };\n};\n\nexport const getInitialProductState = (config: ConfigContextProps) =>\n  config.products.map(product => ({\n    productType: product.kind,\n    duration: Duration.P30D,\n  }));\n"],"names":[],"mappings":";;;;;;AAuBA,MAAM,MAAS,GAAA,GAAA,CACZ,MAAO,EAAA,CACP,KAAM,CAAA;AAAA,EACL,KAAO,EAAA,GAAA,CAAI,MAAO,EAAA,CAAE,QAAS,EAAA;AAAA,EAC7B,OAAS,EAAA,GAAA,CAAI,MAAO,EAAA,CAAE,QAAS;AACjC,CAAC,EACA,QAAS,EAAA;AAEC,MAAA,SAAA,GAAY,CAAC,WACxB,KAAA,EAAA,CAAG,UAAU,WAAa,EAAA,EAAE,kBAAoB,EAAA,IAAA,EAAM;AAE3C,MAAA,KAAA,GAAQ,CAAC,WAAA,KACpB,EAAG,CAAA,KAAA,CAAM,WAAa,EAAA,EAAE,iBAAmB,EAAA,IAAA,EAAM,kBAAoB,EAAA,IAAA,EAAM;AAEhE,MAAA,QAAA,GAAW,CAAC,WAA8C,KAAA;AACrE,EAAA,OAAO,MAAO,CAAA,QAAA,CAAS,KAAM,CAAA,WAAW,CAAG,EAAA;AAAA,IACzC,YAAc,EAAA,IAAA;AAAA,IACd,MAAQ,EAAA;AAAA,GACT,CAAA;AACH;AAEO,MAAM,mBAAsB,GAAA,CACjC,MACA,EAAA,WAAA,GAAoC,EACjC,KAAA;AACH,EAAO,OAAA;AAAA,IACL,GAAG,sBAAsB,MAAM,CAAA;AAAA,IAC/B,GAAI,YAAY,OAAU,GAAA,EAAE,SAAS,WAAY,CAAA,OAAA,KAAY,EAAC;AAAA,IAC9D,GAAI,YAAY,KAAQ,GAAA,EAAE,OAAO,WAAY,CAAA,KAAA,KAAU;AAAC,GAC1D;AACF;AAEO,MAAM,yBAAyB,CAAC,MAAA,KACrC,MAAO,CAAA,QAAA,CAAS,IAAI,CAAY,OAAA,MAAA;AAAA,EAC9B,aAAa,OAAQ,CAAA,IAAA;AAAA,EACrB,UAAU,QAAS,CAAA;AACrB,CAAE,CAAA;;;;"}