{"version":3,"file":"loading.esm.js","sources":["../../src/utils/loading.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Duration, Loading } from '../types';\nimport {\n  Entity,\n  Maybe,\n  Product,\n} from '@backstage-community/plugin-cost-insights-common';\nimport { DEFAULT_DURATION } from './duration';\n\nexport type ProductState = {\n  product: Product;\n  entity: Maybe<Entity>;\n  duration: Duration;\n};\n\nexport enum DefaultLoadingAction {\n  UserGroups = 'user-groups',\n  LastCompleteBillingDate = 'billing-date',\n  CostInsightsInitial = 'cost-insights-initial',\n  CostInsightsPage = 'cost-insights-page',\n  CostInsightsProducts = 'cost-insights-products',\n  CostInsightsAlerts = 'cost-insights-alerts',\n}\n\nexport const INITIAL_LOADING_ACTIONS = [\n  DefaultLoadingAction.UserGroups,\n  DefaultLoadingAction.CostInsightsInitial,\n  DefaultLoadingAction.CostInsightsProducts,\n];\n\nexport const getDefaultState = (loadingActions: string[]): Loading => {\n  return loadingActions.reduce(\n    (defaultState, action) => ({ ...defaultState, [action]: true }),\n    {},\n  );\n};\n\nexport const getResetState = (loadingActions: string[]): Loading => {\n  return loadingActions.reduce(\n    (defaultState, action) => ({ ...defaultState, [action]: false }),\n    {},\n  );\n};\n\nexport const getResetStateWithoutInitial = (\n  loadingActions: string[],\n): Loading => {\n  return loadingActions.reduce((defaultState, action) => {\n    const loadingActionState = (INITIAL_LOADING_ACTIONS as string[]).includes(\n      action,\n    )\n      ? false\n      : true;\n    return { ...defaultState, [action]: loadingActionState };\n  }, {});\n};\n\nexport const settledResponseOf = (\n  responses: PromiseSettledResult<Entity | any>[],\n): Array<Maybe<Entity>> => {\n  return responses.map(response =>\n    response.status === 'fulfilled' ? response.value : null,\n  );\n};\n\nexport const initialStatesOf = (\n  products: Product[],\n  responses: Array<Maybe<Entity>>,\n): ProductState[] => {\n  return products.map((product, index) => ({\n    entity: responses[index],\n    product: product,\n    duration: DEFAULT_DURATION,\n  }));\n};\n"],"names":["DefaultLoadingAction"],"mappings":";;AA8BY,IAAA,oBAAA,qBAAAA,qBAAL,KAAA;AACL,EAAAA,sBAAA,YAAa,CAAA,GAAA,aAAA;AACb,EAAAA,sBAAA,yBAA0B,CAAA,GAAA,cAAA;AAC1B,EAAAA,sBAAA,qBAAsB,CAAA,GAAA,uBAAA;AACtB,EAAAA,sBAAA,kBAAmB,CAAA,GAAA,oBAAA;AACnB,EAAAA,sBAAA,sBAAuB,CAAA,GAAA,wBAAA;AACvB,EAAAA,sBAAA,oBAAqB,CAAA,GAAA,sBAAA;AANX,EAAAA,OAAAA,qBAAAA;AAAA,CAAA,EAAA,oBAAA,IAAA,EAAA;AASL,MAAM,uBAA0B,GAAA;AAAA,EACrC,aAAA;AAAA,EACA,uBAAA;AAAA,EACA,wBAAA;AACF;AAEa,MAAA,eAAA,GAAkB,CAAC,cAAsC,KAAA;AACpE,EAAA,OAAO,cAAe,CAAA,MAAA;AAAA,IACpB,CAAC,cAAc,MAAY,MAAA,EAAE,GAAG,YAAc,EAAA,CAAC,MAAM,GAAG,IAAK,EAAA,CAAA;AAAA,IAC7D;AAAC,GACH;AACF;AAEa,MAAA,aAAA,GAAgB,CAAC,cAAsC,KAAA;AAClE,EAAA,OAAO,cAAe,CAAA,MAAA;AAAA,IACpB,CAAC,cAAc,MAAY,MAAA,EAAE,GAAG,YAAc,EAAA,CAAC,MAAM,GAAG,KAAM,EAAA,CAAA;AAAA,IAC9D;AAAC,GACH;AACF;AAEa,MAAA,2BAAA,GAA8B,CACzC,cACY,KAAA;AACZ,EAAA,OAAO,cAAe,CAAA,MAAA,CAAO,CAAC,YAAA,EAAc,MAAW,KAAA;AACrD,IAAA,MAAM,qBAAsB,uBAAqC,CAAA,QAAA;AAAA,MAC/D;AAAA,QAEE,KACA,GAAA,IAAA;AACJ,IAAA,OAAO,EAAE,GAAG,YAAA,EAAc,CAAC,MAAM,GAAG,kBAAmB,EAAA;AAAA,GACzD,EAAG,EAAE,CAAA;AACP;AAEa,MAAA,iBAAA,GAAoB,CAC/B,SACyB,KAAA;AACzB,EAAA,OAAO,SAAU,CAAA,GAAA;AAAA,IAAI,CACnB,QAAA,KAAA,QAAA,CAAS,MAAW,KAAA,WAAA,GAAc,SAAS,KAAQ,GAAA;AAAA,GACrD;AACF;AAEa,MAAA,eAAA,GAAkB,CAC7B,QAAA,EACA,SACmB,KAAA;AACnB,EAAA,OAAO,QAAS,CAAA,GAAA,CAAI,CAAC,OAAA,EAAS,KAAW,MAAA;AAAA,IACvC,MAAA,EAAQ,UAAU,KAAK,CAAA;AAAA,IACvB,OAAA;AAAA,IACA,QAAU,EAAA;AAAA,GACV,CAAA,CAAA;AACJ;;;;"}