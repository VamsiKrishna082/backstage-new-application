{"version":3,"file":"useWorkflowRunJobs.esm.js","sources":["../../../src/components/WorkflowRunDetails/useWorkflowRunJobs.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport useAsync, { AsyncState } from 'react-use/esm/useAsync';\nimport { githubActionsApiRef, Job, Jobs, Step } from '../../api';\nimport { buildRouteRef } from '../../routes';\nimport { useApi, useRouteRefParams } from '@backstage/core-plugin-api';\n\nexport const useWorkflowRunJobs = ({\n  hostname,\n  owner,\n  repo,\n}: {\n  hostname?: string;\n  owner: string;\n  repo: string;\n}): AsyncState<Jobs> => {\n  const api = useApi(githubActionsApiRef);\n  const { id } = useRouteRefParams(buildRouteRef);\n\n  return useAsync(async () => {\n    if (!repo || !owner) {\n      throw new Error('No repo/owner provided');\n    }\n\n    const jobs = await api.listJobsForWorkflowRun({\n      hostname,\n      owner,\n      repo,\n      id: parseInt(id, 10),\n    });\n\n    return {\n      total_count: jobs.total_count,\n      jobs: jobs.jobs.map<Job>(job => ({\n        html_url: job.html_url ?? undefined,\n        status: job.status,\n        conclusion: job.conclusion ?? undefined,\n        started_at: job.started_at,\n        completed_at: job.completed_at ?? undefined,\n        id: job.id,\n        name: job.name,\n        steps: job.steps?.map<Step>(step => ({\n          name: step.name,\n          status: step.status,\n          conclusion: step.conclusion ?? undefined,\n          number: step.number,\n          started_at: step.started_at ?? undefined,\n          completed_at: step.completed_at ?? undefined,\n        })),\n      })),\n    };\n  }, [repo, owner, id]);\n};\n"],"names":[],"mappings":";;;;;;;AAoBO,MAAM,qBAAqB,CAAC;AAAA,EACjC,QAAA;AAAA,EACA,KAAA;AAAA,EACA;AACF,CAIwB,KAAA;AACtB,EAAM,MAAA,GAAA,GAAM,OAAO,mBAAmB,CAAA;AACtC,EAAA,MAAM,EAAE,EAAA,EAAO,GAAA,iBAAA,CAAkB,aAAa,CAAA;AAE9C,EAAA,OAAO,SAAS,YAAY;AAC1B,IAAI,IAAA,CAAC,IAAQ,IAAA,CAAC,KAAO,EAAA;AACnB,MAAM,MAAA,IAAI,MAAM,wBAAwB,CAAA;AAAA;AAG1C,IAAM,MAAA,IAAA,GAAO,MAAM,GAAA,CAAI,sBAAuB,CAAA;AAAA,MAC5C,QAAA;AAAA,MACA,KAAA;AAAA,MACA,IAAA;AAAA,MACA,EAAA,EAAI,QAAS,CAAA,EAAA,EAAI,EAAE;AAAA,KACpB,CAAA;AAED,IAAO,OAAA;AAAA,MACL,aAAa,IAAK,CAAA,WAAA;AAAA,MAClB,IAAM,EAAA,IAAA,CAAK,IAAK,CAAA,GAAA,CAAS,CAAQ,GAAA,MAAA;AAAA,QAC/B,QAAA,EAAU,IAAI,QAAY,IAAA,KAAA,CAAA;AAAA,QAC1B,QAAQ,GAAI,CAAA,MAAA;AAAA,QACZ,UAAA,EAAY,IAAI,UAAc,IAAA,KAAA,CAAA;AAAA,QAC9B,YAAY,GAAI,CAAA,UAAA;AAAA,QAChB,YAAA,EAAc,IAAI,YAAgB,IAAA,KAAA,CAAA;AAAA,QAClC,IAAI,GAAI,CAAA,EAAA;AAAA,QACR,MAAM,GAAI,CAAA,IAAA;AAAA,QACV,KAAO,EAAA,GAAA,CAAI,KAAO,EAAA,GAAA,CAAU,CAAS,IAAA,MAAA;AAAA,UACnC,MAAM,IAAK,CAAA,IAAA;AAAA,UACX,QAAQ,IAAK,CAAA,MAAA;AAAA,UACb,UAAA,EAAY,KAAK,UAAc,IAAA,KAAA,CAAA;AAAA,UAC/B,QAAQ,IAAK,CAAA,MAAA;AAAA,UACb,UAAA,EAAY,KAAK,UAAc,IAAA,KAAA,CAAA;AAAA,UAC/B,YAAA,EAAc,KAAK,YAAgB,IAAA,KAAA;AAAA,SACnC,CAAA;AAAA,OACF,CAAA;AAAA,KACJ;AAAA,GACC,EAAA,CAAC,IAAM,EAAA,KAAA,EAAO,EAAE,CAAC,CAAA;AACtB;;;;"}