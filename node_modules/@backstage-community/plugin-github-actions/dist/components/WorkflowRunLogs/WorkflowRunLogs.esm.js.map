{"version":3,"file":"WorkflowRunLogs.esm.js","sources":["../../../src/components/WorkflowRunLogs/WorkflowRunLogs.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport { LogViewer } from '@backstage/core-components';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Fade from '@material-ui/core/Fade';\nimport Modal from '@material-ui/core/Modal';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport Zoom from '@material-ui/core/Zoom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport DescriptionIcon from '@material-ui/icons/Description';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { useState } from 'react';\nimport { getProjectNameFromEntity } from '../getProjectNameFromEntity';\nimport { useDownloadWorkflowRunLogs } from './useDownloadWorkflowRunLogs';\nimport { getHostnameFromEntity } from '../getHostnameFromEntity';\n\nconst useStyles = makeStyles(theme => ({\n  button: {\n    order: -1,\n    marginRight: 0,\n    marginLeft: '-20px',\n  },\n  modal: {\n    display: 'flex',\n    alignItems: 'center',\n    width: '85%',\n    height: '85%',\n    justifyContent: 'center',\n    margin: 'auto',\n  },\n  normalLogContainer: {\n    height: '75vh',\n    width: '100%',\n  },\n  modalLogContainer: {\n    height: '100%',\n    width: '100%',\n  },\n  log: {\n    background: theme.palette.background.default,\n  },\n}));\n\n/**\n * A component for Run Logs visualization.\n */\nexport const WorkflowRunLogs = ({\n  entity,\n  runId,\n  inProgress,\n}: {\n  entity: Entity;\n  runId: number;\n  inProgress: boolean;\n}) => {\n  const classes = useStyles();\n  const projectName = getProjectNameFromEntity(entity);\n\n  const hostname = getHostnameFromEntity(entity);\n  const [owner, repo] = (projectName && projectName.split('/')) || [];\n  const jobLogs = useDownloadWorkflowRunLogs({\n    hostname,\n    owner,\n    repo,\n    id: runId,\n  });\n  const logText = jobLogs.value ? String(jobLogs.value) : undefined;\n  const [open, setOpen] = useState(false);\n\n  const handleOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <Accordion TransitionProps={{ unmountOnExit: true }} disabled={inProgress}>\n      <AccordionSummary\n        expandIcon={<ExpandMoreIcon />}\n        IconButtonProps={{\n          className: classes.button,\n        }}\n      >\n        <Typography variant=\"button\">\n          {jobLogs.loading ? <CircularProgress /> : 'Job Log'}\n        </Typography>\n        <Tooltip title=\"Open Log\" TransitionComponent={Zoom} arrow>\n          <DescriptionIcon\n            onClick={event => {\n              event.stopPropagation();\n              handleOpen();\n            }}\n            style={{ marginLeft: 'auto' }}\n          />\n        </Tooltip>\n        <Modal\n          className={classes.modal}\n          onClick={event => event.stopPropagation()}\n          open={open}\n          onClose={handleClose}\n        >\n          <Fade in={open}>\n            <div className={classes.modalLogContainer}>\n              <LogViewer\n                text={logText ?? 'No Values Found'}\n                classes={{ root: classes.log }}\n              />\n            </div>\n          </Fade>\n        </Modal>\n      </AccordionSummary>\n      {logText && (\n        <div className={classes.normalLogContainer}>\n          <LogViewer text={logText} classes={{ root: classes.log }} />\n        </div>\n      )}\n    </Accordion>\n  );\n};\n"],"names":[],"mappings":"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"}