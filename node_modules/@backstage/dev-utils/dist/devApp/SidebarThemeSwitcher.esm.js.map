{"version":3,"file":"SidebarThemeSwitcher.esm.js","sources":["../../src/devApp/SidebarThemeSwitcher.tsx"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SidebarItem } from '@backstage/core-components';\nimport { appThemeApiRef, useApi } from '@backstage/core-plugin-api';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport AutoIcon from '@material-ui/icons/BrightnessAuto';\nimport { MouseEvent, cloneElement, useCallback, useState } from 'react';\nimport useObservable from 'react-use/esm/useObservable';\n\ntype ThemeIconProps = {\n  active?: boolean;\n  icon: JSX.Element | undefined;\n};\n\nconst ThemeIcon = ({ active, icon }: ThemeIconProps) =>\n  icon ? (\n    cloneElement(icon, {\n      color: active ? 'primary' : undefined,\n    })\n  ) : (\n    <AutoIcon color={active ? 'primary' : undefined} />\n  );\n\nexport const SidebarThemeSwitcher = () => {\n  const appThemeApi = useApi(appThemeApiRef);\n  const themeId = useObservable(\n    appThemeApi.activeThemeId$(),\n    appThemeApi.getActiveThemeId(),\n  );\n  const themeIds = appThemeApi.getInstalledThemes();\n  const activeTheme = themeIds.find(t => t.id === themeId);\n\n  const [anchorEl, setAnchorEl] = useState<Element | undefined>();\n  const open = Boolean(anchorEl);\n\n  const handleOpen = (event: MouseEvent) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleSelectTheme = (newThemeId: string | undefined) => {\n    if (themeIds.some(t => t.id === newThemeId)) {\n      appThemeApi.setActiveThemeId(newThemeId);\n    } else {\n      appThemeApi.setActiveThemeId(undefined);\n    }\n\n    setAnchorEl(undefined);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(undefined);\n  };\n\n  const ActiveIcon = useCallback(\n    () => <ThemeIcon icon={activeTheme?.icon} />,\n    [activeTheme],\n  );\n\n  return (\n    <>\n      <SidebarItem\n        icon={ActiveIcon}\n        text=\"Switch Theme\"\n        id=\"theme-button\"\n        aria-haspopup=\"listbox\"\n        aria-controls=\"theme-menu\"\n        aria-label=\"switch theme\"\n        aria-expanded={open ? 'true' : undefined}\n        onClick={handleOpen}\n      />\n\n      <Menu\n        id=\"theme-menu\"\n        anchorEl={anchorEl}\n        open={open}\n        onClose={handleClose}\n        MenuListProps={{\n          'aria-labelledby': 'theme-button',\n          role: 'listbox',\n        }}\n      >\n        <MenuItem disabled>Choose a theme</MenuItem>\n        <MenuItem\n          selected={themeId === undefined}\n          onClick={() => handleSelectTheme(undefined)}\n        >\n          <ListItemIcon>\n            <ThemeIcon icon={undefined} active={themeId === undefined} />\n          </ListItemIcon>\n          <ListItemText>Auto</ListItemText>\n        </MenuItem>\n\n        {themeIds.map(theme => {\n          const active = theme.id === themeId;\n          return (\n            <MenuItem\n              key={theme.id}\n              selected={active}\n              aria-selected={active}\n              onClick={() => handleSelectTheme(theme.id)}\n            >\n              <ListItemIcon>\n                <ThemeIcon icon={theme.icon} active={active} />\n              </ListItemIcon>\n              <ListItemText>{theme.title}</ListItemText>\n            </MenuItem>\n          );\n        })}\n      </Menu>\n    </>\n  );\n};\n"],"names":[],"mappings":"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"}