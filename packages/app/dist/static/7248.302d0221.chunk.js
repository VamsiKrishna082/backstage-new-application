"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7248],{15998:(nt,y,t)=>{t.d(y,{$3:()=>O,Rr:()=>g,be:()=>A});var e=t(49724);function u(c){return!!c.getFullTextFilters}function O(c){const I=c.reduce((j,B)=>({...j,...B.getCatalogFilters?B.getCatalogFilters():{}}),{}),E=c.find(u)?.getFullTextFilters();return{filter:I,fullTextFilter:E}}function g(c){const I={};return c.forEach(E=>{E instanceof e.q_||E instanceof e.N9||E instanceof e.I5||E instanceof e.z||E instanceof e.tN||E instanceof e.Kf||E instanceof e.V3||E instanceof e.gZ||Object.assign(I,E.getCatalogFilters?.()||{})}),I}function A(c){return I=>c.every(E=>!E.filterEntity||E.filterEntity(I))}},18453:(nt,y,t)=>{t.d(y,{B9:()=>C,nK:()=>n});var e=t(31085),u=t(45250),O=t.n(u),g=t(45810),A=t.n(g),c=t(14041),I=t(18690),E=t(87290),j=t(22771),B=t(71581),_=t(30043),d=t(15998),V=t(18139);const v=(0,c.createContext)(void 0),C=i=>{const F=(0,B.A)(),Q=(0,V.gf)(_.v),[U,S]=(0,c.useState)({}),x=(0,I.zy)(),m=i.pagination===!0?"cursor":typeof i.pagination=="object"?i.pagination.mode??"cursor":"none",J=typeof i.pagination=="object"?i.pagination.limit??20:20,{queryParameters:Z,cursor:X,offset:k,limit:at}=(0,c.useMemo)(()=>{const P=A().parse(x.search,{ignoreQueryPrefix:!0});let L=J;if(typeof P.limit=="string"){const s=Number.parseInt(P.limit,10);isNaN(s)||(L=s)}const a=typeof P.offset=="string"&&m==="offset"?Number.parseInt(P.offset,10):void 0;return{queryParameters:P.filters??{},cursor:typeof P.cursor=="string"&&m==="cursor"?P.cursor:void 0,offset:m==="offset"&&a&&!isNaN(a)?a:void 0,limit:L}},[m,x.search,J]),[M,b]=(0,c.useState)(X),[T,w]=(0,c.useState)(k),[G,ct]=(0,c.useState)(at),[K,q]=(0,c.useState)(()=>({appliedFilters:{},entities:[],backendEntities:[],pageInfo:{},offset:T,limit:G})),[{loading:rt,error:Y},tt]=(0,E.A)(async()=>{const P=(0,u.compact)(Object.values(U)),L=Object.keys(U).reduce((a,s)=>{const r=U[s];return r?.toQueryValue&&(a[s]=r.toQueryValue()),a},{});if(m!=="none")if(M){if(M!==K.appliedCursor){const a=(0,d.be)(P),s=await Q.queryEntities({cursor:M,limit:G});q({appliedFilters:U,appliedCursor:M,backendEntities:s.items,entities:s.items.filter(a),pageInfo:s.pageInfo,totalItems:s.totalItems})}}else{const a=(0,d.be)(P),s=(0,d.$3)(P),r=(0,d.$3)((0,u.compact)(Object.values(K.appliedFilters)));if(m==="offset"&&(K.limit!==G||K.offset!==T)||!(0,u.isEqual)(r,s)){const o=await Q.queryEntities({...s,limit:G,offset:T,orderFields:[{field:"metadata.name",order:"asc"}]});q({appliedFilters:U,backendEntities:o.items,entities:o.items.filter(a),pageInfo:o.pageInfo,totalItems:o.totalItems,limit:G,offset:T})}}else{const a=(0,d.be)(P),s=(0,d.Rr)(P),r=(0,d.Rr)((0,u.compact)(Object.values(K.appliedFilters)));if((0,u.isEqual)(r,s)){const o=K.backendEntities.filter(a);q({appliedFilters:U,backendEntities:K.backendEntities,entities:o,totalItems:o.length})}else{const o=await Q.getEntities({filter:s}),l=o.items.filter(a);q({appliedFilters:U,backendEntities:o.items,entities:l,totalItems:l.length})}}if(F()){const a=A().parse(x.search,{ignoreQueryPrefix:!0}),s=A().stringify({...a,filters:L,cursor:M,offset:T,limit:G},{addQueryPrefix:!0,arrayFormat:"repeat"}),r=`${window.location.pathname}${s}`;window.history?.replaceState(null,document.title,r)}},[Q,Z,U,K,M,m,G,T],{loading:!0});(0,j.A)(tt,10,[U,M,G,T]);const et=(0,c.useCallback)(P=>{m==="cursor"?b(void 0):m==="offset"&&w(0),S(L=>{const a=typeof P=="function"?P(L):P;return{...L,...a}})},[m]),ot=(0,c.useMemo)(()=>{if(m!=="cursor")return;const P=K.pageInfo?.prevCursor,L=K.pageInfo?.nextCursor;return{prev:P?()=>b(P):void 0,next:L?()=>b(L):void 0}},[m,K.pageInfo]),it=(0,c.useMemo)(()=>({filters:K.appliedFilters,entities:K.entities,backendEntities:K.backendEntities,updateFilters:et,queryParameters:Z,loading:rt,error:Y,pageInfo:ot,totalItems:K.totalItems,limit:G,offset:T,setLimit:ct,setOffset:w,paginationMode:m}),[K,et,Z,rt,Y,ot,G,T,m,ct,w]);return(0,e.jsx)(v.Provider,{value:it,children:i.children})};function n(){const i=(0,c.useContext)(v);if(!i)throw new Error("useEntityList must be used within EntityListProvider");return i}},30117:(nt,y,t)=>{t.d(y,{y:()=>a});var e=t(31085),u=t(18139),O=t(54195),g=t(40703),A=t(58007),c=t(46423),I=t(65569),E=t(5951),j=t(26343),B=t(72501),_=t(58837),d=t(9684),V=t(92483),v=t(14041),C=t(49724),n=t(18453),i=t(46343),F=t(40074),Q=t(46123),U=t(96403),S=t(94223),x=t(45250),p=t(73466),m=t(30043),J=t(15998),Z=t(87290),X=function(s){return s!==Object(s)},k=function(s,r,o){var l=(0,v.useRef)(void 0);(!l.current||!o(r,l.current))&&(l.current=r),(0,v.useEffect)(s,l.current)};const at=k;var M=t(56307),b=t.n(M);const T=b();var w=function(s){return s!==Object(s)},G=function(s,r){at(s,r,T)};const ct=G;function K(){const s=(0,u.gf)(S.K),r=(0,u.gf)(m.v),{filters:o}=(0,n.nK)(),{value:l,loading:f}=(0,p.A)(async()=>(await s.getBackstageIdentity()).ownershipEntityRefs,[]),{user:h,owners:R,...H}=o,W=(0,J.$3)((0,x.compact)(Object.values(H))),[{value:D,loading:$},ut]=(0,Z.A)(async st=>{const mt=q(st.owners,st.ownershipEntityRefs);if(mt===void 0)return 0;const{["metadata.name"]:gt,...N}=st.filter.filter,{totalItems:z}=await r.queryEntities({...st.filter,filter:{...N,"relations.ownedBy":mt},limit:0});return z},[],{loading:!0});return ct(()=>{Object.keys(W.filter).length!==0&&l!==void 0&&ut({ownershipEntityRefs:l,owners:R,filter:W})},[l,R,W]),{count:D,loading:f||$,filter:(0,v.useMemo)(()=>C.tN.owned(l??[]),[l]),ownershipEntityRefs:l}}function q(s,r){if(r===void 0)return;const o=s?.values??[];if(o.length){const l=(0,x.intersection)(o,r);return l.length===0?void 0:l}return r}function rt(){const s=(0,u.gf)(m.v),{filters:r}=(0,n.nK)(),o=(0,v.useRef)(),l=(0,v.useMemo)(()=>{const{user:R,...H}=r,W=(0,x.compact)(Object.values(H)),D=(0,J.$3)(W),$={...D,limit:0};return Object.keys(D.filter).length===0?(o.current=void 0,o.current):(0,x.isEqual)($,o.current)?o.current:(o.current=$,$)},[r]),{value:f,loading:h}=(0,p.A)(async()=>{if(l===void 0)return 0;const{totalItems:R}=await s.queryEntities(l);return R},[l]);return{count:f,loading:h}}var Y=t(78560),tt=t(44861);function et(){const s=(0,u.gf)(m.v),{filters:r}=(0,n.nK)(),{starredEntities:o}=(0,tt.I)(),l=(0,v.useRef)(),f=(0,v.useMemo)(()=>{const{user:W,...D}=r,$=(0,x.compact)(Object.values(D)),ut=(0,J.$3)($),st={...ut,filter:{...ut.filter,["metadata.name"]:Array.from(o).map(mt=>(0,Y.KU)(mt).name)},limit:1e3};return(0,x.isEqual)(st,l.current)?l.current:(l.current=st,st)},[r,o]),{value:h,loading:R}=(0,p.A)(async()=>o.size?(await s.queryEntities(f)).items.map(D=>(0,Y.U2)({kind:D.kind,namespace:D.metadata.namespace,name:D.metadata.name})).filter(D=>o.has(D)).length:0,[f,o]),H=(0,v.useMemo)(()=>C.tN.starred(Array.from(o)),[o]);return{count:h,loading:R,filter:H}}var ot=t(10265),it=t(80084);const P=(0,_.A)(s=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:s.spacing(1,0,1,0)},title:{margin:s.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:s.palette.text.primary},menuItem:{minHeight:s.spacing(6)},groupWrapper:{margin:s.spacing(1,1,2,1)}}),{name:"CatalogReactUserListPicker"});function L(s,r){return[{name:r("userListPicker.personalFilter.title"),items:[{id:"owned",label:r("userListPicker.personalFilter.ownedLabel"),icon:d.A},{id:"starred",label:r("userListPicker.personalFilter.starredLabel"),icon:V.Gg}]},{name:s,items:[{id:"all",label:r("userListPicker.orgFilterAllLabel")}]}]}const a=s=>{const{initialFilter:r,availableFilters:o,hidden:l,alwaysKeepFilters:f}=s,h=P(),R=(0,u.gf)(O.U),{t:H}=(0,ot.i)(it.j),W=R.getOptionalString("organization.name")??H("userListPicker.defaultOrgName"),{filters:D,updateFilters:$,queryParameters:{kind:ut,user:vt}}=(0,n.nK)(),st=["starred","all"],mt=L(W,H).map(dt=>({...dt,items:dt.items.filter(({id:lt})=>["group","user"].some(At=>At===ut)?st.includes(lt):!o||o.includes(lt))})).filter(({items:dt})=>!!dt.length),{count:gt,loading:N,filter:z}=K(),{count:ft}=rt(),{count:pt,filter:Ct,loading:Mt}=et(),ht=(0,v.useMemo)(()=>[vt].flat()[0],[vt]),[Et,Ot]=(0,v.useState)(ht??r),Pt=(0,v.useMemo)(()=>({all:ft,starred:pt,owned:gt}),[pt,gt,ft]);(0,v.useEffect)(()=>{ht&&Ot(ht)},[ht]);const yt=N||Mt;return(0,v.useEffect)(()=>{!yt&&Et&&Et!=="all"&&Pt[Et]===0&&!f&&Ot("all")},[yt,Pt,Et,Ot,f]),(0,v.useEffect)(()=>{if(!Et||yt)return;$({user:Et==="owned"?z:Et==="starred"?Ct:C.tN.all()})},[Et,Ct,z,$,yt]),l?null:(0,e.jsx)(g.A,{className:h.root,children:mt.map(dt=>(0,e.jsxs)(v.Fragment,{children:[(0,e.jsx)(B.A,{variant:"subtitle2",component:"span",className:h.title,children:dt.name}),(0,e.jsx)(g.A,{className:h.groupWrapper,children:(0,e.jsx)(A.A,{disablePadding:!0,dense:!0,role:"menu","aria-label":dt.name,children:dt.items.map((lt,At)=>(0,e.jsxs)(j.A,{role:"none presentation",divider:At!==dt.items.length-1,onClick:()=>Ot(lt.id),selected:lt.id===D.user?.value,className:h.menuItem,disabled:Pt[lt.id]===0,"data-testid":`user-picker-${lt.id}`,tabIndex:0,ContainerProps:{role:"menuitem"},children:[lt.icon&&(0,e.jsx)(c.A,{className:h.listIcon,children:(0,e.jsx)(lt.icon,{fontSize:"small"})}),(0,e.jsx)(E.A,{children:(0,e.jsxs)(B.A,{variant:"body1",children:[lt.label," "]})}),(0,e.jsx)(I.A,{children:Pt[lt.id]??"-"})]},lt.id))})})]},dt.name))})}},40941:(nt,y,t)=>{t.d(y,{t:()=>L});var e=t(31085),u=t(78560),O=t(77125),g=t(69076),A=t(86901),c=t(72501),I=t(71677),E=t(58837),j=t(7031),B=t(44148),_=t(41260),d=t(14041),V=t(18453),v=t(49724),C=t(16261);function n(a){const s=(0,C.J)(a);(0,d.useEffect)(()=>()=>{s.current()},[])}function i(a,s,r,o=0){const l=(0,d.useRef)(),f=(0,d.useRef)(),h=(0,d.useRef)(a),R=(0,d.useRef)(),H=()=>{l.current&&(clearTimeout(l.current),l.current=void 0),f.current&&(clearTimeout(f.current),f.current=void 0)};return n(H),(0,d.useEffect)(()=>{h.current=a},s),(0,d.useMemo)(()=>{const W=()=>{if(H(),!R.current)return;const $=R.current;R.current=void 0,h.current.apply($.this,$.args)},D=function(...$){l.current&&clearTimeout(l.current),R.current={args:$,this:this},l.current=setTimeout(W,r),o>0&&!f.current&&(f.current=setTimeout(W,o))};return Object.defineProperties(D,{length:{value:a.length},name:{value:`${a.name||"anonymous"}__debounced__${r}`}}),D},[r,o,...s])}function F(a,s,r,o=0){(0,d.useEffect)(i(a,s,r,o),s)}var Q=t(48108),U=t(47966),S=t(53318),x=t(18139),p=t(87290),m=t(30043);function J({enabled:a}){const s=(0,x.gf)(m.v),[r]=(0,d.useState)(async()=>{if(!a)return[];const o="relations.ownedBy";return s.getEntityFacets({facets:[o]}).then(l=>l.facets[o].map(f=>f.value).map(f=>{const{kind:h,name:R,namespace:H}=(0,u.KU)(f);return{apiVersion:"backstage.io/v1beta1",kind:h,metadata:{name:R,namespace:H}}}).sort((f,h)=>f.kind.localeCompare(h.kind,"en-US")||f.metadata.namespace.localeCompare(h.metadata.namespace,"en-US")||f.metadata.name.localeCompare(h.metadata.name,"en-US"))).catch(()=>[])});return(0,p.A)(async(o,l)=>{const f=await r;if(!f)return{items:[]};const h=l?.limit??20,{text:R,start:H}=Z(o),W=f.filter($=>at(R,$)),D=H+h;return{items:W.slice(0,D),...k({entities:W,limit:D,payload:{text:R,start:D}})}},[r],{loading:!0,value:{items:[]}})}function Z(a){return X(a)&&a.cursor?JSON.parse(atob(a.cursor)):{text:a.text||"",start:0}}function X(a){return!!a.cursor}function k({entities:a,limit:s,payload:r}){return a.length>s?{cursor:btoa(JSON.stringify(r))}:{}}function at(a,s){const r=a.trim();return s.kind.includes(r)||s.metadata.namespace?.includes(r)||s.metadata.name.includes(r)}function M(){const a=(0,x.gf)(m.v);return(0,p.A)(async(s,r)=>{const o=s,l=s,f=r?.limit??20;if(l.cursor){const R=await a.queryEntities({cursor:l.cursor,limit:f});return{cursor:R.pageInfo.nextCursor,items:[...l.items,...R.items]}}const h=await a.queryEntities({fullTextFilter:{term:o.text||"",fields:["metadata.name","kind","spec.profile.displayname","metadata.title"]},filter:{kind:["User","Group"]},orderFields:[{field:"metadata.name",order:"asc"}],limit:f});return{cursor:h.pageInfo.nextCursor,items:h.items}},[],{loading:!0})}var b=t(76842);function T({mode:a,initialSelectedOwnersRefs:s}){const r=a==="owners-only",o=M(),l=J({enabled:r}),[f,h]=r?l:o;return[f,h,w({enabled:!r,initialSelectedOwnersRefs:s})]}function w({enabled:a,initialSelectedOwnersRefs:s}){const r=(0,d.useRef)({}),o=(0,x.gf)(m.v),[,l]=(0,p.A)(async()=>{(await o.getEntitiesByRefs({entityRefs:s})).items.forEach(h=>{h&&(r.current[(0,u.U2)(h)]=h)})},[]);return(0,b.u)(()=>{a&&s.length>0&&l()}),{getEntity:f=>r.current[f],setEntity:f=>{r.current[(0,u.U2)(f)]=f}}}var G=t(46123),ct=t(46509),K=t(96403),q=t(80084),rt=t(10265),Y=t(57101);const tt=(0,E.A)({root:{},label:{},input:{},fullWidth:{width:"100%"},boxLabel:{width:"100%",textOverflow:"ellipsis",overflow:"hidden"}},{name:"CatalogReactEntityOwnerPicker"}),et=(0,j.A)(a=>({label:{width:"100%"},root:{width:"90%"}}),{name:"FixedWidthFormControlLabel"})(A.A),ot=(0,e.jsx)(_.A,{fontSize:"small"}),it=(0,e.jsx)(B.A,{fontSize:"small"});function P(a){const s=tt(),r=a.entity.kind.toLocaleLowerCase("en-US")==="group",{primaryTitle:o}=(0,ct.f)(a.entity);return(0,e.jsx)(O.A,{className:s.fullWidth,children:(0,e.jsx)(et,{className:s.fullWidth,control:(0,e.jsx)(g.A,{icon:ot,checkedIcon:it,checked:a.isSelected}),onClick:l=>l.preventDefault(),label:(0,e.jsx)(I.Ay,{title:o,children:(0,e.jsxs)(O.A,{display:"flex",alignItems:"center",children:[r?(0,e.jsx)(U.A,{fontSize:"small"}):(0,e.jsx)(Q.A,{fontSize:"small"}),"\xA0",(0,e.jsx)(O.A,{className:s.boxLabel,children:(0,e.jsx)(c.A,{noWrap:!0,children:o})})]})})})})}const L=a=>{const s=tt(),{mode:r="owners-only"}=a||{},{updateFilters:o,filters:l,queryParameters:{owners:f}}=(0,V.nK)(),[h,R]=(0,d.useState)(""),{t:H}=(0,rt.i)(q.j),W=(0,d.useMemo)(()=>[f].flat().filter(Boolean),[f]),[D,$]=(0,d.useState)(W.length?W:l.owners?.values??[]),[{value:ut,loading:vt},st,mt]=T({mode:r,initialSelectedOwnersRefs:D});F(()=>st({text:h}),[h,st],250);const gt=ut?.items||[];return(0,d.useEffect)(()=>{if(W.length){const N=new v.N9(W);$(N.values)}},[W]),(0,d.useEffect)(()=>{o({owners:D.length?new v.N9(D):void 0})},[D,o]),["user","group"].includes(l.kind?.value.toLocaleLowerCase("en-US")||"")?null:(0,e.jsx)(O.A,{className:s.root,pb:1,pt:1,children:(0,e.jsx)(Y.Q,{label:H("entityOwnerPicker.title"),multiple:!0,disableCloseOnSelect:!0,loading:vt,options:gt,value:D,getOptionSelected:(N,z)=>typeof z=="string"?(0,u.U2)(N)===z:N===z,getOptionLabel:N=>{const z=typeof N=="string"?mt.getEntity(N)||(0,u.KU)(N,{defaultKind:"group",defaultNamespace:"default"}):N;return(0,S.Z)(z,(0,S.S)(z))},onChange:(N,z)=>{R(""),$(z.map(ft=>{const pt=typeof ft=="string"?ft:(0,u.U2)(ft);return typeof ft!="string"&&mt.setEntity(ft),pt}))},filterOptions:N=>N,renderOption:(N,{selected:z})=>(0,e.jsx)(P,{entity:N,isSelected:z}),name:"owner-picker",onInputChange:(N,z)=>{R(z)},ListboxProps:{onScroll:N=>{const z=N.currentTarget;Math.abs(z.scrollHeight-z.clientHeight-z.scrollTop)<1&&ut?.cursor&&st({items:ut.items,cursor:ut.cursor})},"data-testid":"owner-picker-listbox"},LabelProps:{className:s.label},TextFieldProps:{className:s.input}})})}},41260:(nt,y,t)=>{var e,u=t(4293),O=t(78920);e={value:!0},y.A=void 0;var g=O(t(14041)),A=u(t(74044)),c=(0,A.default)(g.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");y.A=c},44148:(nt,y,t)=>{var e,u=t(4293),O=t(78920);e={value:!0},y.A=void 0;var g=O(t(14041)),A=u(t(74044)),c=(0,A.default)(g.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");y.A=c},44861:(nt,y,t)=>{t.d(y,{I:()=>_});var e=t(78560),u=t(18139),O=t(14041),g=t(11746),A=t(46123),c=t.n(A),I=t(9974),E=t(96403),j=t.n(E);function B(d){return typeof d=="string"?d:(0,e.U2)(d)}function _(){const d=(0,u.gf)(I.a),V=(0,g.A)((0,O.useMemo)(()=>d.starredEntitie$(),[d]),new Set),v=(0,O.useCallback)(n=>V.has(B(n)),[V]),C=(0,O.useCallback)(n=>d.toggleStarred(B(n)).then(),[d]);return{starredEntities:V,toggleStarredEntity:C,isStarredEntity:v}}},47966:(nt,y,t)=>{var e,u=t(4293),O=t(78920);e={value:!0},y.A=void 0;var g=O(t(14041)),A=u(t(74044)),c=(0,A.default)(g.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");y.A=c},49724:(nt,y,t)=>{t.d(y,{I5:()=>j,Kf:()=>V,N9:()=>E,V3:()=>I,gM:()=>g,gZ:()=>d,mT:()=>v,qA:()=>A,q_:()=>c,tN:()=>_,z:()=>B});var e=t(78560),u=t(97214),O=t(699);class g{constructor(n,i){this.value=n,this.label=i}getCatalogFilters(){return{kind:this.value}}toQueryValue(){return this.value}}class A{constructor(n){this.value=n}getTypes(){return Array.isArray(this.value)?this.value:[this.value]}getCatalogFilters(){return{"spec.type":this.getTypes()}}toQueryValue(){return this.getTypes()}}class c{constructor(n){this.values=n}filterEntity(n){return this.values.every(i=>(n.metadata.tags??[]).includes(i))}getCatalogFilters(){return{"metadata.tags":this.values}}toQueryValue(){return this.values}}class I{constructor(n){this.value=n}filterEntity(n){const i=this.toUpperArray(this.value.split(/\s/)),F=this.toUpperArray([n.metadata.tags]),Q=this.toUpperArray([n.metadata.name,n.metadata.title,n.spec?.profile?.displayName]);for(const U of i)if(F.every(S=>S!==U)&&Q.every(S=>!S.includes(U)))return!1;return!0}getFullTextFilters(){return{term:this.value,fields:["metadata.name","metadata.title","spec.profile.displayName"]}}toQueryValue(){return this.value}toUpperArray(n){return n.flat().filter(i=>!!i).map(i=>i.toLocaleUpperCase("en-US"))}}class E{values;constructor(n){this.values=n.reduce((i,F)=>{try{return i.push((0,e.U2)((0,e.KU)(F,{defaultKind:"Group"}))),i}catch{return i}},[])}getCatalogFilters(){return{"relations.ownedBy":this.values}}filterEntity(n){return this.values.some(i=>(0,O.t)(n,u.vv).some(F=>(0,e.U2)(F)===i))}toQueryValue(){return this.values}}class j{constructor(n){this.values=n}getCatalogFilters(){return{"spec.lifecycle":this.values}}filterEntity(n){return this.values.some(i=>n.spec?.lifecycle===i)}toQueryValue(){return this.values}}class B{constructor(n){this.values=n}getCatalogFilters(){return{"metadata.namespace":this.values}}filterEntity(n){return this.values.some(i=>n.metadata.namespace===i)}toQueryValue(){return this.values}}class _{constructor(n,i){this.value=n,this.refs=i}static owned(n){return new _("owned",n)}static all(){return new _("all")}static starred(n){return new _("starred",n)}getCatalogFilters(){return this.value==="owned"?{"relations.ownedBy":this.refs??[]}:this.value==="starred"?{"metadata.name":this.refs?.map(n=>(0,e.KU)(n).name)??[]}:{}}filterEntity(n){if(this.value==="starred")return this.refs?.includes((0,e.U2)(n))??!0;if(this.value==="owned"){const i=(0,O.t)(n,u.vv);return this.refs?.some(F=>i.some(Q=>(0,e.U2)(Q)===F))??!1}return!0}toQueryValue(){return this.value}}class d{constructor(n,i,F){this.value=n,this.isOwnedEntity=i,this.isStarredEntity=F}filterEntity(n){switch(this.value){case"owned":return this.isOwnedEntity(n);case"starred":return this.isStarredEntity(n);default:return!0}}toQueryValue(){return this.value}}class V{constructor(n){this.value=n}getCatalogFilters(){return this.value?{"metadata.annotations.backstage.io/orphan":String(this.value)}:{}}filterEntity(n){const i=n.metadata.annotations?.["backstage.io/orphan"];return i!==void 0&&this.value.toString()===i}}class v{constructor(n){this.value=n}filterEntity(n){const i=n?.status?.items?.length>0;return i!==void 0&&this.value===i}}},56420:(nt,y,t)=>{t.d(y,{Y:()=>at});var e=t(31085),u=t(95208),O=t(18139),g=t(54195),A=t(77125),c=t(64947),I=t(93453),E=t(29365),j=t(46423),B=t(5951),_=t(26343),d=t(28233),V=t(55197),v=t(58837),C=t(72501),n=t(5893),i=t(14041),F=t(45250),Q=t.n(F),U=t(70209),S=t(92483),x=t(75202),p=t(89475),m=t(10265);const J=(0,v.A)({popoverList:{minWidth:260,maxWidth:400},menuItem:{whiteSpace:"normal"}},{name:"BackstageSupportButton"}),Z=({icon:M})=>{const b=(0,u.n)(),T=M?b.getSystemIcon(M)??S.NT:S.NT;return(0,e.jsx)(T,{})},X=({link:M})=>(0,e.jsx)(x.N_,{to:M.url,children:M.title??M.url}),k=({item:M})=>(0,e.jsxs)(_.A,{button:!1,children:[(0,e.jsx)(j.A,{children:(0,e.jsx)(Z,{icon:M.icon})}),(0,e.jsx)(B.A,{primary:M.title,secondary:M.links?.reduce((b,T,w)=>[...b,w>0&&(0,e.jsx)("br",{},w),(0,e.jsx)(X,{link:T},T.url)],[])})]});function at(M){const{t:b}=(0,m.i)(p.O),{title:T,items:w,children:G}=M,{items:ct}=(0,U.l)(),[K,q]=(0,i.useState)(!1),[rt,Y]=(0,i.useState)(null),tt=J(),et=(0,O.gf)(g.U).getOptionalConfig("app.support"),ot=(0,n.A)(L=>L.breakpoints.down("sm")),it=L=>{Y(L.currentTarget),q(!0)},P=()=>{q(!1)};return et?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(A.A,{display:"flex",ml:1,children:ot?(0,e.jsx)(E.A,{color:"primary",size:"small",onClick:it,"data-testid":"support-button","aria-label":"Support",children:(0,e.jsx)(S.NT,{})}):(0,e.jsx)(c.A,{"data-testid":"support-button","aria-label":"Support",color:"primary",onClick:it,startIcon:(0,e.jsx)(S.NT,{}),children:b("supportButton.title")})}),(0,e.jsxs)(V.Ay,{"data-testid":"support-button-popover",open:K,anchorEl:rt,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:P,children:[(0,e.jsxs)(d.A,{className:tt.popoverList,autoFocusItem:!!rt,children:[T&&(0,e.jsx)(_.A,{button:!1,alignItems:"flex-start",className:tt.menuItem,children:(0,e.jsx)(C.A,{variant:"subtitle1",children:T})}),i.Children.map(G,(L,a)=>(0,e.jsx)(_.A,{button:!1,alignItems:"flex-start",className:tt.menuItem,children:L},`child-${a}`)),(w??ct).map((L,a)=>(0,e.jsx)(k,{item:L},`item-${a}`))]}),(0,e.jsx)(I.A,{children:(0,e.jsx)(c.A,{color:"primary",onClick:P,"aria-label":"Close",children:b("supportButton.close")})})]})]}):null}},56643:(nt,y,t)=>{t.d(y,{y:()=>S});var e=t(31085),u=t(77125),O=t(58837),g=t(14041),A=t(18139),c=t(73466),I=t(30043),E=t(69076),j=t(86901),B=t(44148),_=t(41260);const d=(0,e.jsx)(_.A,{fontSize:"small"}),V=(0,e.jsx)(B.A,{fontSize:"small"});function v({selected:x}){return(0,e.jsx)(E.A,{icon:d,checkedIcon:V,checked:x})}const C=(0,g.memo)(x=>{const{selected:p,value:m,availableOptions:J,showCounts:Z}=x,X=Z?`${m} (${J?.[m]})`:m;return(0,e.jsx)(j.A,{control:(0,e.jsx)(v,{selected:p}),label:X,onClick:k=>k.preventDefault()})});var n=t(18453),i=t(15998),F=t(57101),Q=t(45250);const U=(0,O.A)({root:{},label:{textTransform:"none",fontWeight:"bold"}},{name:"CatalogReactEntityAutocompletePicker"});function S(x){const{label:p,name:m,path:J,showCounts:Z,Filter:X,InputProps:k,initialSelectedOptions:at=[],filtersForAvailableValues:M=["kind"],hidden:b}=x,T=U(),{updateFilters:w,filters:G,queryParameters:{[m]:ct}}=(0,n.nK)(),K=(0,A.gf)(I.v),q=M.map(a=>G[a]),{value:rt}=(0,c.A)(async()=>{const a=J,{facets:s}=await K.getEntityFacets({facets:[a],filter:(0,i.Rr)(q.filter(Boolean))});return Object.fromEntries(s[a].map(({value:r,count:o})=>[r,o]))},[...q]),Y=(0,g.useMemo)(()=>[ct].flat().filter(Boolean),[ct]),tt=G[m]?.values,[et,ot]=(0,g.useState)(Y.length?Y:tt??at);(0,g.useEffect)(()=>{Y.length&&ot(Y)},[Y]);const it=Object.keys(rt??{}),P=et.length&&it.length;(0,g.useEffect)(()=>{w({[m]:P?new X(et):void 0})},[m,P,et,X,w]),(0,g.useEffect)(()=>{if(!P)return;const a=tt??[];(0,Q.isEqual)(a,et)||ot(a)},[tt]);const L=G[m];return L&&typeof L=="object"&&!("values"in L)||!it.length||b?null:(0,e.jsx)(u.A,{className:T.root,pb:1,pt:1,children:(0,e.jsx)(F.Q,{multiple:!0,disableCloseOnSelect:!0,label:p,name:`${String(m)}-picker`,options:it,value:et,TextFieldProps:k,onChange:(a,s)=>ot(s),renderOption:(a,{selected:s})=>(0,e.jsx)(C,{selected:s,value:a,availableOptions:rt,showCounts:!!Z})})})}},56829:(nt,y,t)=>{t.d(y,{m:()=>E});var e=t(31085),u=t(58837),O=t(49724),g=t(56643),A=t(80084),c=t(10265);const I=(0,u.A)({input:{}},{name:"CatalogReactEntityTagPicker"}),E=j=>{const B=I(),{t:_}=(0,c.i)(A.j);return(0,e.jsx)(g.y,{label:_("entityTagPicker.title"),name:"tags",path:"metadata.tags",Filter:O.q_,showCounts:j.showCounts,InputProps:{className:B.input},initialSelectedOptions:j.initialFilter?j.initialFilter:[],hidden:j.hidden})}},57101:(nt,y,t)=>{t.d(y,{Q:()=>x});var e=t(31085),u=t(77125),O=t(72501),g=t(4321),A=t(87263),c=t(16249),I=t(33145),E=t(58837),j=t(7031),B=t(99703),_=t(6924),d=t(61783),V=t(14041),v=t(45250),C=t.n(v),n=t(53373),i=t.n(n);const F=(0,E.A)(p=>({root:{margin:p.spacing(1,0)},label:{position:"relative",fontWeight:"bold",fontSize:p.typography.body2.fontSize,fontFamily:p.typography.fontFamily,color:p.palette.text.primary,"& > span":{top:0,left:0,position:"absolute"}}}),{name:"BackstageAutocomplete"}),Q=(0,j.A)(p=>(0,B.A)({root:{},paper:{margin:0},hasClearIcon:{},hasPopupIcon:{},focused:{},inputRoot:{marginTop:24,backgroundColor:p.palette.background.paper,"$root$hasClearIcon$hasPopupIcon &":{paddingBlock:p.spacing(.75),paddingInlineStart:p.spacing(.75)},"$root$focused &":{outline:"none"},"$root &:hover > fieldset":{borderColor:"#ced4da"},"$root$focused & > fieldset":{borderWidth:1,borderColor:p.palette.primary.main}},popupIndicator:{padding:0,margin:0,color:"#616161","&:hover":{backgroundColor:"unset"},'& [class*="MuiTouchRipple-root"]':{display:"none"}},endAdornment:{"$root$hasClearIcon$hasPopupIcon &":{right:4}},input:{"$root$hasClearIcon$hasPopupIcon &":{fontSize:p.typography.body1.fontSize,paddingBlock:p.spacing(.8125)}}}),{name:"BackstageAutocompleteBase"})(d.Ay),U=p=>(0,e.jsx)(A.A,{...p,transition:!0,placement:"bottom-start",children:({TransitionProps:m})=>(0,e.jsx)(I.A,{...m,style:{transformOrigin:"0 0 0"},children:(0,e.jsx)(u.A,{children:p.children})})}),S=p=>(0,e.jsx)(g.A,{...p,elevation:8});function x(p){const{label:m,name:J,LabelProps:Z,TextFieldProps:X,...k}=p,at=F(),M=(0,V.useCallback)(T=>(0,e.jsx)(c.A,{...(0,v.merge)(T,X),variant:"outlined"}),[X]),b=(0,e.jsx)(Q,{size:"small",...k,renderInput:k.renderInput??M,popupIcon:(0,e.jsx)(_.A,{"data-testid":`${J}-expand`}),PaperComponent:S,PopperComponent:U});return(0,e.jsx)(u.A,{className:at.root,children:m?(0,e.jsxs)(O.A,{...Z,className:i()(at.label,Z?.className),component:"label",children:[(0,e.jsx)(u.A,{component:"span",children:m}),b]}):b})}},77509:(nt,y,t)=>{t.d(y,{GI:()=>C});var e=t(31085),u=t(14041),O=t(77125),g=t(64947),A=t(73845),c=t(42899),I=t(72501),E=t(5893),j=t(54917),B=t(65859),_=t(80084),d=t(10265);const V=n=>{const i=(0,E.A)(x=>x.breakpoints.down(n.options?.drawerBreakpoint??"md"),{noSsr:!0}),F=(0,j.A)(),[Q,U]=(0,u.useState)(!1),{t:S}=(0,d.i)(_.j);return i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.A,{style:{marginTop:F.spacing(1),marginLeft:F.spacing(1)},onClick:()=>U(!0),startIcon:(0,e.jsx)(B.A,{}),children:S("catalogFilter.buttonTitle")}),(0,e.jsx)(A.Ay,{open:Q,onClose:()=>U(!1),anchor:n.options?.drawerAnchor??"left",disableAutoFocus:!0,keepMounted:!0,variant:"temporary",children:(0,e.jsxs)(O.A,{m:2,children:[(0,e.jsx)(I.A,{variant:"h6",component:"h2",style:{marginBottom:F.spacing(1)},children:S("catalogFilter.title")}),n.children]})})]}):(0,e.jsx)(c.A,{item:!0,lg:2,children:n.children})},v=n=>(0,e.jsx)(c.A,{item:!0,xs:12,lg:10,children:n.children}),C=n=>(0,e.jsx)(c.A,{container:!0,style:{position:"relative"},children:n.children});C.Filters=V,C.Content=v}}]);})();

//# sourceMappingURL=7248.302d0221.chunk.js.map